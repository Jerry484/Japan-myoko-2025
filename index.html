<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>日本滑雪跨年行程 2025</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .timeline-line { position: absolute; left: 1.25rem; top: 0; bottom: 0; width: 2px; background-color: #e5e7eb; z-index: 0; }
        
        /* Markdown Styles */
        .prose p { margin-bottom: 0.5em; }
        .prose ul { list-style-type: disc; padding-left: 1.2em; margin-bottom: 0.5em; }
        .prose ol { list-style-type: decimal; padding-left: 1.2em; margin-bottom: 0.5em; }
        .prose strong { font-weight: 700; color: #1e3a8a; }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 pb-20">

    <nav class="bg-blue-900 text-white sticky top-0 z-50 shadow-lg">
        <div class="max-w-4xl mx-auto px-4 py-3 flex justify-between items-center">
            <div class="font-bold text-lg"><i class="fa-solid fa-snowflake mr-2"></i>Japan Trip 2025</div>
            <div class="text-xs bg-blue-800 px-2 py-1 rounded">12/25 - 12/31</div>
        </div>
    </nav>

    <div class="max-w-4xl mx-auto px-4 py-6 space-y-6">

        <div class="bg-white rounded-lg shadow-sm p-4 border border-slate-200">
            <h3 class="font-bold text-slate-700 mb-3 border-b pb-2">航班資訊</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                <div class="flex items-center">
                    <i class="fa-solid fa-plane-departure text-blue-500 w-8"></i>
                    <div>
                        <div class="font-bold">去程 (UO622)</div>
                        <div class="text-slate-500">12/25 17:55 HKG -> 22:45 HND (T3)</div>
                    </div>
                </div>
                <div class="flex items-center">
                    <i class="fa-solid fa-plane-arrival text-blue-500 w-8"></i>
                    <div>
                        <div class="font-bold">回程</div>
                        <div class="text-red-500 font-bold">⚠️ 12/31 15:25 NRT (T2) -> HKG</div>
                        <div class="text-xs text-slate-400">注意：回程是成田機場，距離妙高非常遠！</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="bg-white rounded-lg shadow-lg overflow-hidden">
            <div class="flex overflow-x-auto bg-slate-100 border-b scrollbar-hide">
                <button onclick="openTab(event, 'day1')" class="tab-btn px-4 py-3 text-sm font-medium whitespace-nowrap border-b-2 border-blue-600 text-blue-600 bg-white hover:text-blue-600 focus:outline-none">
                    Day 1 (12/25)
                </button>
                <button onclick="openTab(event, 'day2')" class="tab-btn px-4 py-3 text-sm font-medium whitespace-nowrap border-b-2 border-transparent hover:text-blue-600 focus:outline-none text-slate-500">
                    Day 2 (12/26)
                </button>
                <button onclick="openTab(event, 'day3')" class="tab-btn px-4 py-3 text-sm font-medium whitespace-nowrap border-b-2 border-transparent hover:text-blue-600 focus:outline-none text-slate-500">
                    Day 3 (12/27)
                </button>
                <button onclick="openTab(event, 'day4')" class="tab-btn px-4 py-3 text-sm font-medium whitespace-nowrap border-b-2 border-transparent hover:text-blue-600 focus:outline-none text-slate-500">
                    Day 4-6 (Ski)
                </button>
                <button onclick="openTab(event, 'day7')" class="tab-btn px-4 py-3 text-sm font-medium whitespace-nowrap border-b-2 border-transparent hover:text-red-600 focus:outline-none text-red-500 font-bold">
                    Day 7 (12/31)⚠️
                </button>
            </div>

            <div class="p-4 min-h-[400px]">
                
                <div id="day1" class="tab-content active">
                    <h2 class="text-xl font-bold mb-4 flex items-center"><i class="fa-solid fa-plane-arrival mr-2 text-blue-500"></i>抵達東京 - 深夜交通戰略</h2>
                    <div class="relative pl-8 space-y-6">
                        <div class="timeline-line"></div>
                        
                        <div class="relative">
                            <div class="absolute -left-10 bg-blue-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold">1</div>
                            <div class="font-bold text-lg">22:45 降落 HND T3</div>
                            <p class="text-sm text-slate-600">過關、拿行李預計需時 45-60 分鐘。</p>
                        </div>

                        <div class="relative">
                            <div class="absolute -left-10 bg-blue-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold">2</div>
                            <div class="font-bold text-lg">23:45 出閘</div>
                            <div class="bg-yellow-50 p-3 rounded mt-2 border border-yellow-200">
                                <h4 class="font-bold text-sm mb-1">交通選擇 (關鍵決策):</h4>
                                <ul class="text-sm list-disc list-inside space-y-1">
                                    <li><strong>首選 (電車):</strong> 京急線 (Keikyu Line) 往品川。尾班車約 00:00 - 00:10。如果你能趕上，這是最便宜的。</li>
                                    <li><strong>次選 (的士):</strong> 如果錯過電車，直接搭的士去品川/新橋。費用約 ¥8,000 - ¥10,000。幾個人分攤其實不貴，也最省力。</li>
                                    <li><strong>備選 (巴士):</strong> 深夜利木津巴士只有去新宿/池袋 (較遠)，不建議，除非你住新宿。</li>
                                </ul>
                            </div>
                        </div>

                        <div class="relative">
                            <div class="absolute -left-10 bg-green-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold">3</div>
                            <div class="font-bold text-lg">入住酒店</div>
                            <p class="text-sm text-slate-600">Ustay Nippori優宿日暮里</p>
                            <p class="text-xs text-gray-500 mt-1">地址：Regency Nippori, 6 Chome-52-8 Higashinippori, Arakawa City, Tokyo 116-0014, Japan</p>
                        </div>
                    </div>
                </div>

                <div id="day2" class="tab-content">
                    <h2 class="text-xl font-bold mb-4 flex items-center"><i class="fa-solid fa-bag-shopping mr-2 text-pink-500"></i>Day 2: 上野・御徒町 二手挖寶之旅</h2>
                    
                    <div class="bg-slate-50 p-3 rounded-lg border border-slate-200 mb-6">
                        <p class="text-xs text-slate-500 mb-2 font-bold"><i class="fa-solid fa-map-location-dot"></i> Chiikawa 風格攻略地圖</p>
                        <img src="chiikawa_map.png" alt="請將你的圖片命名為 chiikawa_map.png 並上傳到 GitHub" class="w-full rounded shadow-md bg-white min-h-[100px] object-cover">
                        <p class="text-[10px] text-slate-400 text-center mt-1">如果圖片未顯示，請確認已將圖片上傳至 GitHub 並命名為 <code>chiikawa_map.png</code></p>
                    </div>

                    <div class="relative pl-8 space-y-8">
                        <div class="timeline-line"></div>

                        <div class="relative">
                            <div class="absolute -left-10 bg-slate-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold">GO</div>
                            <div class="font-bold">09:30 出發</div>
                            <p class="text-sm font-medium">Ustay Nippori優宿日暮里</p>
                            <p class="text-xs text-slate-500"> 京成高砂駅 10-15 分鐘至阿美橫丁入口。</p>
                        </div>

                        <div class="relative">
                            <div class="absolute -left-10 bg-pink-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold">1</div>
                            <div class="font-bold">10:00 阿美橫丁中心大樓</div>
                            <p class="text-sm font-medium text-slate-700">Ameyoko Center Bldg</p>
                            <div class="bg-pink-50 p-2 rounded mt-1 border border-pink-100 text-sm">
                                <p><strong>攻略：</strong>位於阿美橫丁三叉路口。剛開門人最少。</p>
                                <p>🎯 <strong>目標：</strong>直接上 3F/4F 找飾品、銀飾、皮帶。</p>
                            </div>
                        </div>

                        <div class="relative">
                            <div class="absolute -left-10 bg-pink-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold">2</div>
                            <div class="font-bold">11:00 Mode Off 上野御徒町店</div>
                            <p class="text-xs text-slate-500">🚶 走路 2 min</p>
                            <p class="text-sm mt-1">專攻二手衣物，請盡情試穿喜歡的衣服。</p>
                        </div>

                        <div class="relative">
                            <div class="absolute -left-10 bg-pink-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold">3</div>
                            <div class="font-bold">12:00 BOOKOFF SUPER BAZAAR</div>
                            <p class="text-xs text-slate-500">🚶 走路 1 min (就在隔壁)</p>
                            <p class="text-sm mt-1">除了書，還有公仔、名牌包、手錶。建議預留 1.5 小時。</p>
                        </div>

                        <div class="relative">
                            <div class="absolute -left-10 bg-orange-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold"><i class="fa-solid fa-utensils"></i></div>
                            <div class="font-bold text-orange-800">13:30 午餐 (附近吃)</div>
                            <ul class="list-disc list-inside text-sm mt-2 bg-orange-50 p-2 rounded border border-orange-100">
                                <li><strong>肉的大山:</strong> 知名炸肉餅 (Menchi Katsu)。</li>
                                <li><strong>阿美橫丁海鮮丼:</strong> 便宜大碗。</li>
                                <li><strong>鴨 to 蔥:</strong> 超人氣鴨肉拉麵 (若排隊太長請放棄)。</li>
                            </ul>
                        </div>

                        <div class="relative">
                            <div class="absolute -left-10 bg-pink-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold">4</div>
                            <div class="font-bold">14:30 Tanpopo House (たんぽぽハウス)</div>
                            <p class="text-xs text-slate-500">🚶 往南走約 5 min (近御徒町站)</p>
                            <p class="text-sm mt-1"><strong>終極便宜區！</strong>需要花時間「翻找」挖寶。</p>
                        </div>

                        <div class="relative">
                            <div class="absolute -left-10 bg-indigo-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold"><i class="fa-solid fa-mug-hot"></i></div>
                            <div class="font-bold">16:00 自由時間 / 下午茶</div>
                            <p class="text-sm">Komeda's Coffee 或 Doutor 休息。</p>
                            <p class="text-sm">或去 <strong>多慶屋 (Takeya)</strong> 買紫色招牌的零食伴手禮。</p>
                        </div>

                         <div class="relative">
                            <div class="absolute -left-10 bg-slate-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold">END</div>
                            <div class="font-bold">19:30 回程</div>
                            <p class="text-sm">御徒町站 (搭一站電車回上野，或散步回飯店)。</p>
                        </div>
                    </div>
                </div>

                <div id="day3" class="tab-content">
                    <h2 class="text-xl font-bold mb-4 flex items-center"><i class="fa-solid fa-train mr-2 text-blue-500"></i>Day 3: 前往長野與妙高 (12/27)</h2>
                    <div class="relative pl-8 space-y-8">
                        <div class="timeline-line"></div>
                        
                        <div class="relative">
                            <div class="absolute -left-10 bg-slate-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold">10:00</div>
                            <div class="font-bold">Checkout & 集合</div>
                            <p class="text-sm">Nippori Hotel 退房。匯合 Venus 和 Hon。</p>
                        </div>

                        <div class="relative">
                            <div class="absolute -left-10 bg-orange-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold"><i class="fa-solid fa-utensils"></i></div>
                            <div class="font-bold">12:00 - 14:00 午餐</div>
                            <p class="text-sm">東京/上野周邊午餐。</p>
                        </div>

                        <div class="relative">
                            <div class="absolute -left-10 bg-blue-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold">1</div>
                            <div class="font-bold text-blue-800">第一階段：新幹線 (上野 ➔ 長野)</div>
                            
                            <div class="bg-blue-50 p-3 rounded mt-2 border border-blue-100">
                                <p class="text-sm"><strong>時間：</strong>14:38 上野 (UENO) ➔ 16:06 長野 (NAGANO)</p>
                                
                                <button onclick="toggleImage('fig-a')" class="mt-2 text-xs bg-white border border-blue-300 text-blue-600 px-3 py-1.5 rounded-full font-bold shadow-sm hover:bg-blue-50 transition flex items-center gap-1 w-full sm:w-auto justify-center">
                                    <i class="fa-regular fa-image"></i> 查看車次詳情 (Fig A)
                                </button>
                                
                                <div id="fig-a" class="hidden mt-2">
                                    <div class="bg-white p-2 rounded shadow border border-slate-200">
                                        <img src="fig_a.png" alt="Fig A: 新幹線車次" class="w-full rounded">
                                        <p class="text-[10px] text-center text-slate-400 mt-1">Fig A</p>
                                    </div>
                                </div>
                            </div>
                            
                            <p class="text-sm text-slate-600 mt-2"><i class="fa-solid fa-mug-hot"></i> <strong>休息：</strong>抵達長野後有約 1 小時空檔，可買伴手禮。</p>
                        </div>

                        <div class="relative">
                            <div class="absolute -left-10 bg-green-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold">2</div>
                            <div class="font-bold text-green-800">第二階段：信濃鐵道 (長野 ➔ 妙高)</div>
                            
                            <div class="bg-green-50 p-3 rounded mt-2 border border-green-100">
                                <p class="text-sm"><strong>車次：</strong>17:06 長野出發 ➔ 17:52 抵達 妙高高原</p>
                                <p class="text-sm"><strong>車資：</strong>850 日圓 (需購實體票)</p>

                                <button onclick="toggleImage('fig-1')" class="mt-2 text-xs bg-white border border-green-300 text-green-600 px-3 py-1.5 rounded-full font-bold shadow-sm hover:bg-green-50 transition mb-2">
                                    <i class="fa-regular fa-map"></i> 官方路線圖 (Fig 1)
                                </button>
                                <div id="fig-1" class="hidden mb-3">
                                    <div class="bg-white p-2 rounded shadow border border-slate-200">
                                        <img src="fig_1.png" alt="Fig 1: 官方路線" class="w-full rounded">
                                    </div>
                                </div>

                                <div class="border-t border-green-200 pt-2 mt-1">
                                    <p class="text-sm font-bold text-green-900 mb-2">【信濃鐵道乘車步驟指南】</p>
                                    
                                    <button onclick="toggleImage('guide-steps')" class="w-full text-left bg-white border border-green-300 text-green-700 px-3 py-2 rounded-lg shadow-sm hover:bg-green-50 transition flex justify-between items-center text-sm font-bold">
                                        <span><i class="fa-solid fa-shoe-prints mr-1"></i> 點擊查看詳細轉乘圖文步驟</span>
                                        <i class="fa-solid fa-chevron-down"></i>
                                    </button>

                                    <div id="guide-steps" class="hidden mt-2 space-y-3 bg-white p-3 rounded border border-slate-200">
                                        
                                        <div class="text-sm">
                                            <span class="bg-slate-200 text-slate-700 px-1.5 rounded text-xs font-bold">Step 1</span>
                                            <strong>尋找入口：</strong>長野站出口層右方，標示 "Myoko-Kogen"。
                                            <div class="mt-1"><img src="fig_2.png" alt="Fig 2: 入口" class="rounded border w-full"></div>
                                        </div>

                                        <div class="text-sm">
                                            <span class="bg-slate-200 text-slate-700 px-1.5 rounded text-xs font-bold">Step 2</span>
                                            <strong>購票：</strong>入口右側自動售票機。
                                            <div class="mt-1"><img src="fig_3.png" alt="Fig 3: 售票機" class="rounded border w-full"></div>
                                        </div>

                                        <div class="text-sm">
                                            <span class="bg-slate-200 text-slate-700 px-1.5 rounded text-xs font-bold">Step 3</span>
                                            <strong>確認金額：</strong>選擇往「妙高高原」(850円)。
                                            <div class="mt-1"><img src="fig_5.png" alt="Fig 5: 票價" class="rounded border w-full"></div>
                                        </div>

                                        <div class="text-sm">
                                            <span class="bg-slate-200 text-slate-700 px-1.5 rounded text-xs font-bold">Step 4</span>
                                            <strong>前往月台：</strong>通常在第 7 月台。
                                            <div class="mt-1"><img src="fig_6.png" alt="Fig 6: 月台" class="rounded border w-full"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="relative">
                            <div class="absolute -left-10 bg-purple-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold">3</div>
                            <div class="font-bold text-purple-800">抵達與接駁</div>
                            <ul class="text-sm mt-1 list-disc list-inside">
                                <li><strong>18:00</strong> 飯店接駁車 (Hotel Taiko Shuttle) 於妙高高原站接人。</li>
                                <li><strong>18:10</strong> 抵達 Hotel Taiko。</li>
                            </ul>
                        </div>

                    </div>
                </div>

                <div id="day4" class="tab-content">
                    <h2 class="text-xl font-bold mb-4 flex items-center"><i class="fa-solid fa-person-skiing mr-2 text-cyan-500"></i>滑雪日 (12/28 - 12/30)</h2>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="bg-slate-50 p-4 rounded-lg">
                            <h3 class="font-bold border-b pb-2 mb-2">每日時間表</h3>
                            <ul class="space-y-3 text-sm">
                                <li class="flex"><span class="w-16 font-bold text-slate-400">08:00</span> 早餐 (Hotel Taiko)</li>
                                <li class="flex"><span class="w-16 font-bold text-slate-400">09:30</span> 穿好裝備，前往集合點</li>
                                <li class="flex bg-cyan-50 p-1 rounded -mx-1"><span class="w-16 font-bold text-cyan-600">10:00</span> <span class="font-bold text-cyan-800">滑雪課開始 (教練已訂)</span></li>
                                <li class="flex"><span class="w-16 font-bold text-slate-400">12:30</span> 午餐 (含在課程中)</li>
                                <li class="flex bg-cyan-50 p-1 rounded -mx-1"><span class="w-16 font-bold text-cyan-600">16:00</span> <span class="font-bold text-cyan-800">課程結束 / 下山</span></li>
                                <li class="flex"><span class="w-16 font-bold text-slate-400">17:00</span> 浸溫泉 (赤倉溫泉)</li>
                                <li class="flex"><span class="w-16 font-bold text-slate-400">19:00</span> 晚餐</li>
                            </ul>
                        </div>

                        <div class="space-y-4">
                            <div class="bg-yellow-50 p-4 rounded-lg border border-yellow-200">
                                <h3 class="font-bold text-yellow-800 mb-2"><i class="fa-solid fa-utensils"></i> 晚餐危機處理</h3>
                                <p class="text-sm mb-2">如果你訂的房間<strong>沒有包晚餐 (Half Board)</strong>，這幾天會很麻煩。</p>
                                <p class="text-sm font-bold">選項：</p>
                                <ol class="list-decimal list-inside text-sm space-y-1">
                                    <li>現在馬上聯絡 Hotel Taiko 加訂晚餐 (最推薦)。</li>
                                    <li>預約街上餐廳：<em>Shibata (居酒屋), Udon no Aji, Hunter</em>。</li>
                                    <li>便利店：赤倉溫泉街有便利店，但很快被搶空。</li>
                                </ol>
                            </div>

                            <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                                <h3 class="font-bold text-blue-800 mb-2"><i class="fa-solid fa-ticket"></i> 雪票 (Lift Ticket)</h3>
                                <p class="text-sm">通常買 <strong>"Mt. Myoko Common Ticket"</strong> 或單獨買 <strong>"Akakura Onsen/Kanko"</strong> 聯票。</p>
                                <p class="text-sm mt-1">Check-in 時在酒店前台詢問 "Discount Lift Ticket"，通常比雪場買便宜。</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="day7" class="tab-content">
                    <h2 class="text-xl font-bold mb-4 flex items-center text-red-600"><i class="fa-solid fa-plane-departure mr-2"></i>Day 7: 回程 (12/31)</h2>
                    
                    <div class="relative pl-8 space-y-8">
                        <div class="timeline-line"></div>

                        <div class="relative">
                            <div class="absolute -left-10 bg-slate-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold">08:50</div>
                            <div class="font-bold">離開飯店</div>
                            <p class="text-sm">接駁車/計程車從 Hotel Taiko 出發 ➔ 09:00 抵達妙高高原站。</p>
                        </div>

                        <div class="relative">
                            <div class="absolute -left-10 bg-green-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold">09:08</div>
                            <div class="font-bold">信濃鐵道 (往長野)</div>
                            <p class="text-sm">09:08 妙高高原 ➔ 09:52 長野站。</p>
                        </div>

                        <div class="relative">
                            <div class="absolute -left-10 bg-blue-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold">10:26</div>
                            <div class="font-bold text-blue-800">新幹線 (長野 ➔ 東京)</div>
                            
                            <div class="bg-blue-50 p-3 rounded mt-2 border border-blue-100">
                                <p class="text-sm"><strong>車次：</strong>Kagayaki 524 (全車指定席)</p>
                                <p class="text-sm"><strong>時間：</strong>10:26 長野 ➔ 11:52 東京</p>
                                <p class="text-xs text-red-500 font-bold mt-1">⚠️ 請務必提前預約此班次！</p>
                                
                                <button onclick="toggleImage('fig-b')" class="mt-2 text-xs bg-white border border-blue-300 text-blue-600 px-3 py-1.5 rounded-full font-bold shadow-sm hover:bg-blue-50 transition flex items-center gap-1 w-full sm:w-auto justify-center">
                                    <i class="fa-regular fa-image"></i> 查看回程車次 (Fig B)
                                </button>
                                
                                <div id="fig-b" class="hidden mt-2">
                                    <div class="bg-white p-2 rounded shadow border border-slate-200">
                                        <img src="fig_b.png" alt="Fig B: 回程新幹線" class="w-full rounded">
                                        <p class="text-[10px] text-center text-slate-400 mt-1">Fig B</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="relative">
                            <div class="absolute -left-10 bg-red-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold"><i class="fa-solid fa-road"></i></div>
                            <div class="font-bold">前往成田機場 (NRT)</div>
                            <div class="mt-2 space-y-2">
                                <div class="bg-white p-2 border rounded border-l-4 border-l-blue-500 shadow-sm">
                                    <p class="text-sm font-bold text-blue-700">選項 A (推薦 - 最快)</p>
                                    <p class="text-xs">在<strong>「上野站」</strong>下車 (11:47) ➔ 步行至京成上野站 ➔ 轉乘 Skyliner。</p>
                                </div>
                                <div class="bg-white p-2 border rounded border-l-gray-400 shadow-sm">
                                    <p class="text-sm font-bold text-gray-700">選項 B</p>
                                    <p class="text-xs">在<strong>「東京站」</strong>下車 (11:52) ➔ 轉乘 成田特快 N'EX 或 巴士。</p>
                                </div>
                                <p class="text-sm font-bold text-red-700 mt-2">🎯 目標：13:00 - 13:30 必須抵達機場！</p>
                            </div>
                        </div>

                    </div>
                </div>

            </div>
        </div>
        
        <div class="text-center text-xs text-slate-400 mt-8 pb-8">
            <p>Generated by Jerry.</p>
        </div>
    </div>

    <button onclick="toggleAiModal()" class="fixed bottom-6 right-6 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white rounded-full p-4 shadow-xl z-50 transition-transform transform hover:scale-110 flex items-center justify-center w-16 h-16">
        <i class="fa-solid fa-wand-magic-sparkles text-2xl"></i>
    </button>

    <div id="ai-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-end sm:items-center justify-center p-0 sm:p-4">
        <div class="bg-white w-full sm:max-w-md h-[80vh] sm:h-[600px] rounded-t-2xl sm:rounded-2xl shadow-2xl flex flex-col overflow-hidden relative">
            
            <div class="bg-gradient-to-r from-blue-900 to-indigo-900 p-4 text-white flex justify-between items-center">
                <div class="flex items-center gap-2">
                    <i class="fa-solid fa-robot"></i>
                    <h3 class="font-bold">日本旅遊隨身 AI</h3>
                </div>
                <button onclick="toggleAiModal()" class="text-white hover:text-gray-300">
                    <i class="fa-solid fa-xmark text-xl"></i>
                </button>
            </div>

            <div id="chat-output" class="flex-1 overflow-y-auto p-4 space-y-4 bg-slate-50">
                <div class="flex items-start gap-2">
                    <div class="bg-blue-100 rounded-lg p-3 text-sm max-w-[85%] text-slate-800">
                        你好！我是你的日本旅遊助手。🇯🇵<br>
                        我可以幫你翻譯、查詢交通、或建議美食。請問有什麼可以幫你？
                    </div>
                </div>
            </div>
            
            <div class="px-4 py-2 bg-white border-t border-slate-100 overflow-x-auto whitespace-nowrap scrollbar-hide">
                <button onclick="sendQuickQuery('推薦新宿附近適合單人的拉麵店')" class="inline-block bg-slate-100 hover:bg-slate-200 text-slate-700 text-xs px-3 py-1.5 rounded-full mr-2 mb-1">🍜 新宿拉麵</button>
                <button onclick="sendQuickQuery('翻譯成日文：我想從長野站寄行李到成田機場')" class="inline-block bg-slate-100 hover:bg-slate-200 text-slate-700 text-xs px-3 py-1.5 rounded-full mr-2 mb-1">🧳 翻譯:寄行李</button>
                <button onclick="sendQuickQuery('12月25日深夜羽田機場的士去品川大概多少錢？')" class="inline-block bg-slate-100 hover:bg-slate-200 text-slate-700 text-xs px-3 py-1.5 rounded-full mr-2 mb-1">🚕 的士車費</button>
            </div>

            <div class="p-4 bg-white border-t border-slate-200">
                <div class="flex gap-2">
                    <input type="text" id="user-input" placeholder="輸入問題..." class="flex-1 border border-slate-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm">
                    <button onclick="sendChat()" id="send-btn" class="bg-blue-600 hover:bg-blue-700 text-white rounded-lg px-4 py-2 transition-colors">
                        <i class="fa-solid fa-paper-plane"></i>
                    </button>
                </div>
            </div>

            <div id="ai-loading" class="absolute inset-0 bg-white bg-opacity-80 flex flex-col items-center justify-center hidden">
                <div class="animate-spin rounded-full h-10 w-10 border-b-2 border-blue-600 mb-3"></div>
                <div class="text-blue-600 font-bold text-sm">AI 思考中...</div>
            </div>
        </div>
    </div>

    <script>
        // --- Image Toggle Logic (圖文展開功能) ---
        function toggleImage(id) {
            const element = document.getElementById(id);
            if (element.classList.contains('hidden')) {
                element.classList.remove('hidden');
            } else {
                element.classList.add('hidden');
            }
        }

        // --- Tab Logic ---
        function openTab(evt, tabName) {
            var i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tab-content");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].classList.remove("active");
            }
            tablinks = document.getElementsByClassName("tab-btn");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].classList.remove("text-blue-600", "border-blue-600", "bg-white", "text-red-600", "border-red-600");
                if(tablinks[i].textContent.includes('Day 7')) {
                    tablinks[i].classList.add("text-red-500", "border-transparent");
                } else {
                    tablinks[i].classList.add("text-slate-500", "border-transparent");
                }
            }
            document.getElementById(tabName).classList.add("active");
            
            const activeBtn = evt.currentTarget;
            activeBtn.classList.remove("text-slate-500", "border-transparent", "text-red-500");
            
            if(tabName === 'day7') {
                 activeBtn.classList.add("text-red-600", "border-red-600", "bg-white");
            } else {
                 activeBtn.classList.add("text-blue-600", "border-blue-600", "bg-white");
            }
        }

        // --- Gemini AI Logic ---
        // !!! IMPORTANT: PASTE YOUR GOOGLE API KEY BELOW INSIDE THE QUOTES !!!
        const apiKey = "PASTE_YOUR_API_KEY_HERE"; 
        
        const systemPrompt = "You are a helpful and polite travel assistant for a user visiting Japan (Tokyo and Myoko Kogen) from Dec 25-31. Context: User is arriving late at Haneda on Dec 25, shopping in Tokyo on Dec 26, taking Shinkansen to Hotel Taiko (Myoko) on Dec 27. Skiing Dec 28-30. Returning from Narita on Dec 31 (very tight schedule). Answer queries concisely. If asked for translations, provide Japanese text and a simple pronunciation guide. If generating emails, be formal and polite.";

        function toggleAiModal() {
            const modal = document.getElementById('ai-modal');
            modal.classList.toggle('hidden');
        }

        function appendMessage(text, isUser = false) {
            const output = document.getElementById('chat-output');
            const div = document.createElement('div');
            div.className = isUser ? "flex items-end justify-end gap-2" : "flex items-start gap-2";
            
            const bubble = document.createElement('div');
            bubble.className = isUser 
                ? "bg-blue-600 text-white rounded-lg rounded-tr-none p-3 text-sm max-w-[85%]" 
                : "bg-slate-100 border border-slate-200 text-slate-800 rounded-lg rounded-tl-none p-3 text-sm max-w-[85%] prose";
            
            if (isUser) {
                bubble.textContent = text;
            } else {
                bubble.innerHTML = marked.parse(text);
            }

            div.appendChild(bubble);
            output.appendChild(div);
            output.scrollTop = output.scrollHeight;
        }

        async function callGeminiAPI(userQuery) {
            if (apiKey === "PASTE_YOUR_API_KEY_HERE" || apiKey === "") {
                return "⚠️ Please open the code file (index.html) and paste your Google API Key in line 527 to enable the AI features.";
            }

            const loading = document.getElementById('ai-loading');
            loading.classList.remove('hidden');

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: userQuery }] }],
                        systemInstruction: { parts: [{ text: systemPrompt }] }
                    })
                });

                const data = await response.json();
                loading.classList.add('hidden');

                if (data.candidates && data.candidates[0].content) {
                    return data.candidates[0].content.parts[0].text;
                } else if (data.error) {
                    console.error(data.error);
                    return "Error from Google: " + data.error.message;
                } else {
                    return "Sorry, I encountered an error connecting to the AI.";
                }
            } catch (error) {
                console.error("AI Error:", error);
                loading.classList.add('hidden');
                return "Network error. Please try again.";
            }
        }

        async function sendChat() {
            const input = document.getElementById('user-input');
            const text = input.value.trim();
            if (!text) return;

            appendMessage(text, true);
            input.value = '';

            const response = await callGeminiAPI(text);
            appendMessage(response, false);
        }

        async function sendQuickQuery(text) {
            appendMessage(text, true);
            const response = await callGeminiAPI(text);
            appendMessage(response, false);
        }

        document.getElementById('user-input').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') sendChat();
        });
    </script>
</body>
</html>
